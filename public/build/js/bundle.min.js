let pokemonId;document.addEventListener("DOMContentLoaded",(function(){iniciarApp()}));let isRequestPending=!1;function iniciarApp(){const e=window.location.pathname;ocultarAlertas(),busqueda(),menu(),oculta(),window.addEventListener("resize",busqueda),window.addEventListener("resize",oculta),("/"===e||e.includes("pokemon"))&&(consultarAPI(),botonesGrupos(),ApiGrupos()),"/myPokedex"===e&&(ApiGrupos(),favorito(),botonEditarNombre()),"/list"===e&&(consultarLista(),botonesGrupos(),ApiGrupos())}async function consultarAPI(){let e=document.querySelector("#name").textContent;e=e.toLowerCase(),e||(e=numRandom=generarNumeroAleatorio(1,1010));try{const o="https://pokeapi.co/api/v2/pokemon/"+e;resultado=await fetch(o),pokemon=await resultado.json(),muestraPokemon(pokemon),muestraEstadisticas(pokemon),pokemonId=pokemon.id,botonId(pokemonId)}catch(e){noPokemon(),console.log(e)}}function generarNumeroAleatorio(e,o){var t=new Date,n=(9301*(1e4*t.getFullYear()+100*(t.getMonth()+1)+t.getDate())+49297)%233280,a=n/233280;return n=Math.floor(a*(o-e+1))+e}function muestraPokemon(e){const{name:o,height:t,types:n,weight:a,sprites:r}=e,i=r.front_default??r.front_shiny;typePokemon="",n.forEach((function(e){typePokemon+=e.type.name+" "}));const s=document.querySelector("#name"),c=document.querySelector("#height"),l=document.querySelector("#weight"),u=document.querySelector("#image"),d=document.querySelector(".type-pokemon");s.textContent=o,l.textContent="Weight: "+a/10+" Kg",c.textContent="Height: "+t/10+" m",u.src=i,d.textContent=typePokemon}function muestraEstadisticas(e){const{stats:o}=e,t=document.querySelectorAll("#cantidad"),n=document.querySelectorAll("#barra");i=0,o.forEach((function(e){const o=e.base_stat;t[i].textContent=""+o,n[i].style.width=o/2+"%",i++}))}function menu(){const e=document.querySelector(".item-nav"),o=document.querySelector(".enlaces-nav"),t=document.querySelector(".fondo-cierra");e.addEventListener("click",(function(){o.classList.toggle("oculta"),t.classList.remove("oculta")}));document.querySelector(".cerrar").addEventListener("click",(function(){o.classList.add("oculta"),t.classList.add("oculta")})),t.addEventListener("click",(function(){t.classList.add("oculta"),o.classList.add("oculta")})),o.addEventListener("click",e=>{e.stopPropagation()})}function busqueda(){const e=document.querySelector(".busqueda-submit"),o=document.querySelector(".overlay"),t=document.querySelector(".ventana-emergente"),n=document.querySelector(".boton-cierra");window.innerWidth<1024?(e.addEventListener("click",eventosBoton),n.addEventListener("click",(function(){o.classList.add("oculta")})),o.addEventListener("click",(function(){o.classList.add("oculta")}))):e.removeEventListener("click",eventosBoton),t.addEventListener("click",e=>{e.stopPropagation()})}function oculta(){const e=document.querySelector(".enlaces-nav"),o=document.querySelector(".sel");window.innerWidth<1024?(e.classList.add("oculta"),o.classList.add("fondo-cierra"),o.classList.add("oculta")):(e.classList.remove("oculta"),o.classList.remove("fondo-cierra"),o.classList.remove("oculta"))}function eventosBoton(e){const o=document.querySelector(".overlay");e.preventDefault(),o.classList.remove("oculta")}function noPokemon(){const e=document.querySelector(".parte-superior"),o=document.querySelector(".estadisticas");e.classList.add("oculta"),o.classList.add("oculta");const t=document.createElement("DIV"),n=document.createElement("H2"),a=document.createElement("P");t.classList.add("ventana-error"),n.textContent="Â¡Error!",a.textContent="Pokemon not found",t.appendChild(n),t.appendChild(a);document.querySelector(".no-Pokemon").appendChild(t)}function botonId(e){document.querySelectorAll(".boton-valor").forEach(o=>{o.value=e})}function ocultarAlertas(){const e=document.querySelector(".alerta");e&&setTimeout(()=>{e.remove()},4e3)}async function ApiGrupos(){try{const e="http://localhost:3000/api/sesion",o=await fetch(e),t=await o.json(),n="http://localhost:3000/api/grupos?idUsuario="+t.id;respuesta=await fetch(n,{method:"GET"});const a=await respuesta.json(),r=window.location.pathname;"/"===r||r.includes("pokemon")||r.includes("/list")?gruposUsuario(a):mostrarGrupos(a)}catch(e){console.log(e)}}async function mostrarGrupos(e){try{gruponumero=1;for(const o of e){const e=Object.values(o),t=[];for(let o=2;o<8;o++)"0"!=e[o]&&t.push(e[o]);const n=document.querySelectorAll(".nombre-equipo");"Group"!=o.nombre&&(n[gruponumero-1].textContent=""+o.nombre);if(document.querySelectorAll(".valor-tea")[gruponumero-1].value=o.id,largo=t.length,largo>0)for(equipo=".equipo1",j=0;j<largo;j++){const e="https://pokeapi.co/api/v2/pokemon/"+t[j],o=await fetch(e),n=await o.json(),a=document.querySelector(".equipo"+gruponumero).querySelectorAll(".pokemon-equipo");a[j].querySelector(".nombre-pokemon-equipo").textContent="#"+n.id;const r=a[j].querySelector(".without-pokemon");a[j].querySelector(".contenedor-acciones-pokedex").classList.remove("oculta"),r.classList.add("oculta");const i=document.createElement("IMG");i.src=n.sprites.front_default??n.sprites.front_shiny,a[j].insertBefore(i,a[j].children[2]);const s=a[j].querySelector(".valor-pokemon"),c=a[j].querySelector(".valor-equipo");s.value=n.id,c.value=gruponumero}gruponumero++}}catch(e){console.error(e)}}async function favorito(){const e=document.querySelector(".contenedor-favorito"),o=e.querySelector(".pok-favorite");id=o.value;const t="https://pokeapi.co/api/v2/pokemon/"+id;resultado=await fetch(t),pokemon=await resultado.json();e.querySelector(".nombre-fav").textContent=pokemon.name;const n=e.querySelector(".my-favorite"),a=document.createElement("IMG");a.src=pokemon.sprites.front_default??pokemon.sprites.front_shiny,n.appendChild(a);const r=e.querySelector(".habilidades");numeroHabilidades=pokemon.abilities,numeroHabilidades.forEach(e=>{const o=document.createElement("P");o.textContent="-"+e.ability.name,r.appendChild(o)})}function gruposUsuario(e){window.location.pathname.includes("list")?lugar=".pokemons-busqueda-lista":lugar=".boton-index";document.querySelector(lugar).querySelectorAll(".contenedor-grupos-usuario").forEach(o=>{grupoNumero=1,e.forEach(e=>{const t=document.createElement("FORM"),n=document.createElement("BUTTON");t.classList.add("grupo-usuario"),t.method="POST";const a=document.createElement("INPUT");a.type="hidden",a.value=e.id,a.name="grupo";const r=document.createElement("INPUT");r.classList.add("boton-valor"),r.value=pokemonId,r.type="hidden",r.name="id";const i=document.createElement("INPUT");i.value="add",i.type="hidden",i.name="boton",t.appendChild(a),t.appendChild(r),t.appendChild(i),"Group"===e.nombre?n.textContent=e.nombre+" "+grupoNumero:n.textContent=e.nombre,t.appendChild(n),o.appendChild(t),grupoNumero++})})}function botonEditarNombre(){document.querySelectorAll(".titulo-equipo").forEach(e=>{const o=e.querySelector(".boton-editar-nombre"),t=e.querySelector(".overlay-nombre");o.addEventListener("click",(function(){t.classList.remove("oculta");const e=t.querySelector(".ventana-emergente");t.querySelector(".boton-cierra").addEventListener("click",(function(){t.classList.add("oculta")})),t.addEventListener("click",(function(){t.classList.add("oculta")})),e.addEventListener("click",e=>{e.stopPropagation()})}))})}async function consultarLista(){const e=document.querySelector("#botonLista");mainList("id"),e.addEventListener("click",(function(){consultarListaToApi()}))}async function consultarListaToApi(){const e=document.querySelector("#tipo-pokemon").value,o=document.querySelector("#generacion").value,t=document.querySelector("#order").value;""===e&&""===o?mainList(t):""===e&&""!==o?lista(o,"generation",t):""!==e&&""===o?lista(e,"type",t):""!==e&&""!==o&&listaVarios(e,o,t)}async function lista(e,o,t,n=0,a=null){try{if(isRequestPending)return;if(isRequestPending=!0,url="https://pokeapi.co/api/v2/"+o+"/"+e,resultado=await fetch(url),generationPokemones=await resultado.json(),url.includes("https://pokeapi.co/api/v2/generation/")?group=generationPokemones.pokemon_species:group=generationPokemones.pokemon.map(e=>e.pokemon),"next"===a){n=document.querySelectorAll(".boton-next")[0].value}else if("preview"===a){n=document.querySelectorAll(".boton-preview")[0].value}id2=parseInt(n)+20;const r=ordenarGrupo(group,t),i=r.slice(n,id2);times=i.length,ajustarDivs(times),mostrarLista(i);let s=i[0]?r.findIndex(e=>e.name===i[0].name):null;const c=i[19]?r.findIndex(e=>e.name===i[19].name)+1:s;0!==n&&0!==s&&(s-=20),botonesLista(c,s,t,"list",o,e),isRequestPending=!1}catch(e){console.log(e)}}async function listaVarios(e,o,t,n=0,a=null){try{if(isRequestPending)return;isRequestPending=!0;const r=e,i=o;url="https://pokeapi.co/api/v2/type/"+r,resultado=await fetch(url),pokemonesTipo=await resultado.json(),url="https://pokeapi.co/api/v2/generation/"+i,resultado=await fetch(url),pokemonesGeneracion=await resultado.json();const s=pokemonesTipo.pokemon.map(e=>e.pokemon),c=pokemonesGeneracion.pokemon_species;let l=ordenarGrupo(obtenerNombresEnComun(s,c),t);if("next"===a){n=document.querySelectorAll(".boton-next")[0].value}else if("preview"===a){n=document.querySelectorAll(".boton-preview")[0].value}id2=parseInt(n)+20,grupo=l.slice(n,id2),times=grupo.length,ajustarDivs(times),mostrarLista(grupo);let u=grupo[0]?l.findIndex(e=>e.name===grupo[0].name):null;const d=grupo[19]?l.findIndex(e=>e.name===grupo[19].name)+1:u;0!==n&&0!==u&&(u-=20),botonesLista(d,u,t,"varios",r,i),isRequestPending=!1}catch(e){console.log(e)}}async function mainList(e,o=0,t=null){try{if(isRequestPending)return;if(isRequestPending=!0,"next"===t){o=document.querySelectorAll(".boton-next")[0].value}else if("preview"===t){o=document.querySelectorAll(".boton-preview")[0].value}id2=parseInt(o)+20,all=await consultaAllPokemones(),ordenados=ordenarGrupo(all,e),grupo=ordenados.slice(o,id2),times=grupo.length,ajustarDivs(times),mostrarLista(grupo);let n=ordenados.findIndex(e=>e.name===grupo[0].name);const a=grupo[19]?ordenados.findIndex(e=>e.name===grupo[19].name)+1:ordenados.findIndex(e=>e.name===grupo[0].name);0!==o&&0!==n&&(n-=20),botonesLista(a,n,e,"main"),isRequestPending=!1}catch(e){console.log(e)}}function botonesLista(e,o,t,n,a=null,r=null){const i=document.querySelectorAll(".boton-next"),s=document.querySelectorAll(".boton-preview");nameLista=n,tipo=a,generacion=r,orden=t,i.forEach(o=>{o.value=e,o.addEventListener("click",(function(){isRequestPending||("varios"===nameLista?listaVarios(tipo,generacion,orden,e,"next"):"main"===nameLista?mainList(orden,e,"next"):"list"===nameLista&&lista(generacion,tipo,orden,e,"next"))}))}),s.forEach(e=>{e.value=o,e.addEventListener("click",(function(){isRequestPending||("main"===nameLista?mainList(orden,o,"preview"):"varios"===nameLista?listaVarios(tipo,generacion,orden,o,"preview"):"list"===nameLista&&lista(generacion,tipo,orden,o,"preview"))}))})}async function consultaAllPokemones(){url="https://pokeapi.co/api/v2/pokemon/?limit=1281";const e=await fetch(url),o=await e.json();return grupo=o.results,grupo}function mostrarLista(e){setTimeout(async()=>{const o=document.querySelectorAll(".pokemon-lista");let t=0;for(const n of e){const e="https://pokeapi.co/api/v2/pokemon/"+n.name;respuesta=await fetch(e),poke=await respuesta.json();const a=o[t].querySelector(".referencia-pokemon"),r=o[t].querySelector(".nombre-pokemon-lista"),i=o[t].querySelector(".id-pokemon-lista"),s=o[t].querySelector(".imagen-pokemon-lista");o[t].querySelectorAll(".boton-valor").forEach(e=>{e.value=poke.id}),a.href="/pokemon?pokemon-name="+poke.name,r.textContent=poke.name,i.textContent="#"+poke.id,s.src=poke.sprites.front_default??poke.sprites.front_shiny,t++}},800)}function ordenarGrupo(e,o){return"id"===o?e:"abeceInverso"===o?(e.sort((e,o)=>e.name>o.name?-1:e.name<o.name?1:void 0),e):(e.sort((e,o)=>e.name<o.name?-1:e.name>o.name?1:void 0),e)}function ajustarDivs(e){const o=document.querySelector(".pokemons-busqueda-lista"),t=o.querySelectorAll(".pokemon-lista"),n=t[0].innerHTML;if(numDivs=t.length,e<numDivs)for(i=e;i<numDivs;i++)t[i].remove();else if(e>numDivs)for(i=numDivs;i<e;i++){const e=document.createElement("DIV");e.classList.add("pokemon-lista"),e.innerHTML=n,o.appendChild(e)}}function obtenerNombresEnComun(e,o){return e.filter(e=>o.map(e=>e.name).includes(e.name)).map(e=>({name:e.name}))}function botonesGrupos(){window.location.pathname.includes("list")?lugar=".pokemon-lista":lugar=".boton-index";document.querySelectorAll(lugar).forEach(e=>{const o=e.querySelector(".boton-cerrar"),t=e.querySelector(".boton-aÃ±adir"),n=e.querySelector(".boton-add"),a=e.querySelector(".fondo"),r=e.querySelector(".deten");t.addEventListener("click",(function(){n.classList.remove("oculta"),a.classList.remove("oculta")})),a.addEventListener("click",(function(){n.classList.add("oculta"),a.classList.add("oculta")})),o.addEventListener("click",(function(){n.classList.add("oculta"),a.classList.add("oculta")})),r.addEventListener("click",e=>{e.stopPropagation()})})}
/*! modernizr 3.6.0 (Custom Build) | MIT *
 * https://modernizr.com/download/?-webp-setclasses !*/!function(e,o,t){function n(e,o){return typeof e===o}function a(e){var o=d.className,t=l._config.classPrefix||"";if(m&&(o=o.baseVal),l._config.enableJSClass){var n=new RegExp("(^|\\s)"+t+"no-js(\\s|$)");o=o.replace(n,"$1"+t+"js$2")}l._config.enableClasses&&(o+=" "+t+e.join(" "+t),m?d.className.baseVal=o:d.className=o)}function r(e,o){if("object"==typeof e)for(var t in e)u(e,t)&&r(t,e[t]);else{var n=(e=e.toLowerCase()).split("."),i=l[n[0]];if(2==n.length&&(i=i[n[1]]),void 0!==i)return l;o="function"==typeof o?o():o,1==n.length?l[n[0]]=o:(!l[n[0]]||l[n[0]]instanceof Boolean||(l[n[0]]=new Boolean(l[n[0]])),l[n[0]][n[1]]=o),a([(o&&0!=o?"":"no-")+n.join("-")]),l._trigger(e,o)}return l}var i=[],s=[],c={_version:"3.6.0",_config:{classPrefix:"",enableClasses:!0,enableJSClass:!0,usePrefixes:!0},_q:[],on:function(e,o){var t=this;setTimeout((function(){o(t[e])}),0)},addTest:function(e,o,t){s.push({name:e,fn:o,options:t})},addAsyncTest:function(e){s.push({name:null,fn:e})}},l=function(){};l.prototype=c,l=new l;var u,d=o.documentElement,m="svg"===d.nodeName.toLowerCase();!function(){var e={}.hasOwnProperty;u=n(e,"undefined")||n(e.call,"undefined")?function(e,o){return o in e&&n(e.constructor.prototype[o],"undefined")}:function(o,t){return e.call(o,t)}}(),c._l={},c.on=function(e,o){this._l[e]||(this._l[e]=[]),this._l[e].push(o),l.hasOwnProperty(e)&&setTimeout((function(){l._trigger(e,l[e])}),0)},c._trigger=function(e,o){if(this._l[e]){var t=this._l[e];setTimeout((function(){var e;for(e=0;e<t.length;e++)(0,t[e])(o)}),0),delete this._l[e]}},l._q.push((function(){c.addTest=r})),l.addAsyncTest((function(){function e(e,o,t){function n(o){var n=!(!o||"load"!==o.type)&&1==a.width;r(e,"webp"===e&&n?new Boolean(n):n),t&&t(o)}var a=new Image;a.onerror=n,a.onload=n,a.src=o}var o=[{uri:"data:image/webp;base64,UklGRiQAAABXRUJQVlA4IBgAAAAwAQCdASoBAAEAAwA0JaQAA3AA/vuUAAA=",name:"webp"},{uri:"data:image/webp;base64,UklGRkoAAABXRUJQVlA4WAoAAAAQAAAAAAAAAAAAQUxQSAwAAAABBxAR/Q9ERP8DAABWUDggGAAAADABAJ0BKgEAAQADADQlpAADcAD++/1QAA==",name:"webp.alpha"},{uri:"data:image/webp;base64,UklGRlIAAABXRUJQVlA4WAoAAAASAAAAAAAAAAAAQU5JTQYAAAD/////AABBTk1GJgAAAAAAAAAAAAAAAAAAAGQAAABWUDhMDQAAAC8AAAAQBxAREYiI/gcA",name:"webp.animation"},{uri:"data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAAAAAAfQ//73v/+BiOh/AAA=",name:"webp.lossless"}],t=o.shift();e(t.name,t.uri,(function(t){if(t&&"load"===t.type)for(var n=0;n<o.length;n++)e(o[n].name,o[n].uri)}))})),function(){var e,o,t,a,r,c;for(var u in s)if(s.hasOwnProperty(u)){if(e=[],(o=s[u]).name&&(e.push(o.name.toLowerCase()),o.options&&o.options.aliases&&o.options.aliases.length))for(t=0;t<o.options.aliases.length;t++)e.push(o.options.aliases[t].toLowerCase());for(a=n(o.fn,"function")?o.fn():o.fn,r=0;r<e.length;r++)1===(c=e[r].split(".")).length?l[c[0]]=a:(!l[c[0]]||l[c[0]]instanceof Boolean||(l[c[0]]=new Boolean(l[c[0]])),l[c[0]][c[1]]=a),i.push((a?"":"no-")+c.join("-"))}}(),a(i),delete c.addTest,delete c.addAsyncTest;for(var p=0;p<l._q.length;p++)l._q[p]();e.Modernizr=l}(window,document);
//# sourceMappingURL=bundle.js.map
